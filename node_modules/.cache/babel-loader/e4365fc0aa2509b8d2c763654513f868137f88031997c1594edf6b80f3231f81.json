{"ast":null,"code":"var _jsxFileName = \"/home/kerim/Belgeler/algoritma1/src/components/DecodeForm.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport UPNG from 'upng-js';\nimport ImageUploadBox from './ImageUploadBox';\nimport ImageDisplayBox from './ImageDisplayBox';\nimport './DecodeForm.css';\nimport { decodeWithSSS } from '../encodeWithSSS';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DecodeForm = () => {\n  _s();\n  const [inputImages, setInputImages] = useState([null, null, null]);\n  const [decodedImage, setDecodedImage] = useState(null);\n  const sharesRef = useRef([]);\n  const handleImageUpload = (file, index) => {\n    if (!file) {\n      console.error(\"No file selected!\");\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = e => {\n      var _e$target;\n      if (!((_e$target = e.target) !== null && _e$target !== void 0 && _e$target.result)) return;\n      const arrayBuffer = e.target.result;\n      const png = UPNG.decode(arrayBuffer);\n      const rawPixels = new Uint8Array(UPNG.toRGBA8(png)[0]);\n\n      // Extract image number from first pixel's alpha channel\n      const imageNumber = rawPixels[3] & 0b00000111;\n      console.log(`Image ${index + 1} number:`, imageNumber);\n\n      // Extract the hidden 2-bit chunks from each channel\n      const extractedBits = [];\n      for (let i = 0; i < rawPixels.length; i += 4) {\n        // Skip alpha channel (i+3)\n        extractedBits.push(rawPixels[i] & 0b00000011); // R\n        extractedBits.push(rawPixels[i + 1] & 0b00000011); // G\n        extractedBits.push(rawPixels[i + 2] & 0b00000011); // B\n      }\n\n      // Store the share data with its image number\n      sharesRef.current[index] = {\n        imageNumber,\n        extractedBits\n      };\n\n      // Update the input image preview\n      const newInputImages = [...inputImages];\n      newInputImages[index] = URL.createObjectURL(file);\n      setInputImages(newInputImages);\n    };\n    reader.onerror = error => {\n      console.error('File reading error:', error);\n    };\n    reader.readAsArrayBuffer(file);\n  };\n  const handleDecode = () => {\n    // Check if we have all 3 required images\n    if (sharesRef.current.filter(Boolean).length < 3) {\n      alert('Please upload all 3 required images for decoding');\n      return;\n    }\n\n    // Sort shares by their image number (1-6)\n    const sortedShares = [...sharesRef.current].sort((a, b) => a.imageNumber - b.imageNumber);\n\n    // Reconstruct the original bytes from the 2-bit chunks\n    const reconstructedPixels = [];\n    const bitChunks = sortedShares.flatMap(share => share.extractedBits);\n\n    // Combine every 4 chunks (8 bits) into a byte\n    for (let i = 0; i < bitChunks.length; i += 4) {\n      if (i + 3 >= bitChunks.length) break;\n      const byte = bitChunks[i] << 6 | bitChunks[i + 1] << 4 | bitChunks[i + 2] << 2 | bitChunks[i + 3];\n      reconstructedPixels.push(byte);\n    }\n\n    // Create RGBA buffer (assuming original was RGBA)\n    const width = Math.sqrt(reconstructedPixels.length / 4);\n    const height = width;\n    const rgba = new Uint8Array(reconstructedPixels.length);\n    for (let i = 0; i < reconstructedPixels.length; i++) {\n      rgba[i] = reconstructedPixels[i];\n    }\n\n    // Create PNG from the reconstructed data\n    const pngData = UPNG.encode([rgba.buffer], width, height, 0);\n    const url = URL.createObjectURL(new Blob([pngData], {\n      type: \"image/png\"\n    }));\n    setDecodedImage(url);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"decode-form\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"decode-section section-inputs\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Upload 3 Shares for Decoding\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"decode-input-grid\",\n        children: [0, 1, 2].map(index => /*#__PURE__*/_jsxDEV(ImageUploadBox, {\n          label: `Share ${index + 1}`,\n          onImageUpload: file => handleImageUpload(file, index)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleDecode,\n        className: \"decode-action-button\",\n        children: \"Decode Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"decode-section section-output\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Reconstructed Image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ImageDisplayBox, {\n        imageSrc: decodedImage || 'https://via.placeholder.com/250/DDDDDD/000000?Text=DecodedImageHere',\n        altText: \"Decoded Result\",\n        className: \"decoded-image-display\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n};\n_s(DecodeForm, \"Qvea0IGq0mz8lnhcN+JvTlXcWGI=\");\n_c = DecodeForm;\nexport default DecodeForm;\nvar _c;\n$RefreshReg$(_c, \"DecodeForm\");","map":{"version":3,"names":["React","useState","useRef","UPNG","ImageUploadBox","ImageDisplayBox","decodeWithSSS","jsxDEV","_jsxDEV","DecodeForm","_s","inputImages","setInputImages","decodedImage","setDecodedImage","sharesRef","handleImageUpload","file","index","console","error","reader","FileReader","onload","e","_e$target","target","result","arrayBuffer","png","decode","rawPixels","Uint8Array","toRGBA8","imageNumber","log","extractedBits","i","length","push","current","newInputImages","URL","createObjectURL","onerror","readAsArrayBuffer","handleDecode","filter","Boolean","alert","sortedShares","sort","a","b","reconstructedPixels","bitChunks","flatMap","share","byte","width","Math","sqrt","height","rgba","pngData","encode","buffer","url","Blob","type","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","label","onImageUpload","onClick","imageSrc","altText","_c","$RefreshReg$"],"sources":["/home/kerim/Belgeler/algoritma1/src/components/DecodeForm.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\nimport UPNG from 'upng-js';\nimport ImageUploadBox from './ImageUploadBox';\nimport ImageDisplayBox from './ImageDisplayBox';\nimport './DecodeForm.css';\nimport { decodeWithSSS } from '../encodeWithSSS';\n\nconst DecodeForm = () => {\n  const [inputImages, setInputImages] = useState([null, null, null]);\n  const [decodedImage, setDecodedImage] = useState(null);\n  const sharesRef = useRef([]);\n\n  const handleImageUpload = (file, index) => {\n    if (!file) {\n      console.error(\"No file selected!\");\n      return;\n    }\n\n    const reader = new FileReader();\n    \n    reader.onload = (e) => {\n      if (!e.target?.result) return;\n      const arrayBuffer = e.target.result;\n      const png = UPNG.decode(arrayBuffer);\n      const rawPixels = new Uint8Array(UPNG.toRGBA8(png)[0]);\n      \n      // Extract image number from first pixel's alpha channel\n      const imageNumber = rawPixels[3] & 0b00000111;\n      console.log(`Image ${index+1} number:`, imageNumber);\n\n      // Extract the hidden 2-bit chunks from each channel\n      const extractedBits = [];\n      for (let i = 0; i < rawPixels.length; i += 4) {\n        // Skip alpha channel (i+3)\n        extractedBits.push(rawPixels[i] & 0b00000011);   // R\n        extractedBits.push(rawPixels[i+1] & 0b00000011); // G\n        extractedBits.push(rawPixels[i+2] & 0b00000011); // B\n      }\n\n      // Store the share data with its image number\n      sharesRef.current[index] = {\n        imageNumber,\n        extractedBits\n      };\n\n      // Update the input image preview\n      const newInputImages = [...inputImages];\n      newInputImages[index] = URL.createObjectURL(file);\n      setInputImages(newInputImages);\n    };\n\n    reader.onerror = (error) => {\n      console.error('File reading error:', error);\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  const handleDecode = () => {\n    // Check if we have all 3 required images\n    if (sharesRef.current.filter(Boolean).length < 3) {\n      alert('Please upload all 3 required images for decoding');\n      return;\n    }\n\n    // Sort shares by their image number (1-6)\n    const sortedShares = [...sharesRef.current].sort((a, b) => a.imageNumber - b.imageNumber);\n    \n    // Reconstruct the original bytes from the 2-bit chunks\n    const reconstructedPixels = [];\n    const bitChunks = sortedShares.flatMap(share => share.extractedBits);\n    \n    // Combine every 4 chunks (8 bits) into a byte\n    for (let i = 0; i < bitChunks.length; i += 4) {\n      if (i + 3 >= bitChunks.length) break;\n      \n      const byte = (bitChunks[i] << 6) | \n                   (bitChunks[i+1] << 4) | \n                   (bitChunks[i+2] << 2) | \n                   bitChunks[i+3];\n      reconstructedPixels.push(byte);\n    }\n\n    // Create RGBA buffer (assuming original was RGBA)\n    const width = Math.sqrt(reconstructedPixels.length / 4);\n    const height = width;\n    const rgba = new Uint8Array(reconstructedPixels.length);\n    \n    for (let i = 0; i < reconstructedPixels.length; i++) {\n      rgba[i] = reconstructedPixels[i];\n    }\n\n    // Create PNG from the reconstructed data\n    const pngData = UPNG.encode([rgba.buffer], width, height, 0);\n    const url = URL.createObjectURL(new Blob([pngData], { type: \"image/png\" }));\n    setDecodedImage(url);\n  };\n\n  return (\n    <div className=\"decode-form\">\n      <div className=\"decode-section section-inputs\">\n        <h3>Upload 3 Shares for Decoding</h3>\n        <div className=\"decode-input-grid\">\n          {[0, 1, 2].map((index) => (\n            <ImageUploadBox\n              key={index}\n              label={`Share ${index + 1}`}\n              onImageUpload={(file) => handleImageUpload(file, index)}\n            />\n          ))}\n        </div>\n        <button onClick={handleDecode} className=\"decode-action-button\">\n          Decode Image\n        </button>\n      </div>\n\n      <div className=\"decode-section section-output\">\n        <h3>Reconstructed Image</h3>\n        <ImageDisplayBox\n          imageSrc={decodedImage || 'https://via.placeholder.com/250/DDDDDD/000000?Text=DecodedImageHere'}\n          altText=\"Decoded Result\"\n          className=\"decoded-image-display\"\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default DecodeForm;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}